# Step 1: Start R and Read the Data Set Back Into Your Workspace
setwd("~/LAB01")
# Step 1: Start R and Read the Data Set Back Into Your Workspace
setwd("C:\Users\naman\Desktop\LECTURES\LECTURES-sem5\dm\Experiment 2")
# Step 1: Start R and Read the Data Set Back Into Your Workspace
setwd("C:/Users/naman/Desktop/LECTURES/LECTURES-sem5/dm/Experiment 2")
options(digits=3)
ls()
load(file="Labs.Rdata")
load(file="Labs.Rdata")
ls()
rm(lab2)
ds <- lab1
colnames(ds) <- c("income", "rooms")
summary(ds$income)
summary(ds$income)
range(ds$income)
sd(ds$income)
var(ds$income)
plot(density(ds$income))  # left skewed
summary(ds$rooms)
range(ds$rooms)
sd(ds$rooms)
plot(as.factor(ds$rooms))
(m <- mean(ds$income, trim=0.10) )
ds <- subset(ds, ds$income  >= 10000 & ds$income < 1000000)
summary(ds)
quantile(ds$income, seq(from=0, to=1, length=11))
breaks <- c(0, 23000, 52000, 82000, 250000, 999999)
labels <- c("Poverty", "LowerMid", "UpperMid", "Wealthy", "Rich")
wealth <- cut(ds$income, breaks, labels)
# add wealth as a column to ds
ds <- cbind(ds, wealth)
# show the 1st few lines.
head(ds)
wt <- table(wealth)
percent <- wt/sum(wt)*100
wt <- rbind(wt, percent)
wt
plot(wt)    # this kind of sucks
nt <- table(wealth, ds$rooms)
print(nt)
# nice mosaic plot
plot(nt)
rm(wealth,breaks,labels)
save(ds, wt, nt, file="Census.Rdata")
library(MASS)
with(ds, {
hist(income, main="Distribution of Household Income",   freq=FALSE)
lines(density(income), lty=2, lwd=2)
xvals = seq(from=min(income), to=max(income),length=100)
param = fitdistr(income, "lognormal")
lines(xvals, dlnorm(xvals, meanlog=param$estimate[1],
sdlog=param$estimate[2]), col="blue")
} )
logincome = log10(ds$income)
hist(logincome, main="Distribution of Household Income", freq=FALSE)
lines(density(logincome), lty=2, lwd=2)  # line type (lty) 2 is dashed
xvals = seq(from=min(logincome), to=max(logincome), length=100)
param = fitdistr(logincome, "normal")
lines(xvals, dnorm(xvals, param$estimate[1],  param$estimate[2]),
lwd=2, col="blue")
#
# Step 7: Correlation  #
with(ds, cor(income, rooms))
with(ds, cor(log(income), rooms) ) # this will give a better correlation
n = length(ds$income)
with(ds, cor(runif(n), rooms))
with(ds,
boxplot(income ~ as.factor(rooms), data=ds, range=0, outline=F, log="y",
xlab="# rooms", ylab="Income")
)
with( ds,
boxplot(rooms ~ wealth, data = ds, main="Room by Wealth", Xlab="Category",
ylab="# rooms")
)
print(wt)
# Step 1.	Execute the following command
q()
offers = sample(c("noffer", "offer1", "offer2"), size=500, replace=T)
head(offers)
purchasesize = ifelse(offers=="noffer", rlnorm(500, meanlog=log(25)), ifelse(offers=="offer1", rlnorm(500, meanlog=log(50)), rlnorm(500, meanlog=log(55))))
head(purchasesize)
offertest = data.frame(offer=offers, purchase_amt=purchasesize)
summary(offertest)
aggregate(x=offertest$purchase_amt, by=list(offertest$offer), FUN="mean")
boxplot(purchase_amt ~ as.factor(offers), data=offertest, log="y")
model = lm(log10(purchase_amt) ~ as.factor(offers), data=offertest)
summary(model)
TukeyHSD(aov(model))
library(lattice)
densityplot(~ purchase_amt, group=offers, data=offertest, auto.key=T)
densityplot(~ log10(purchase_amt), group=offers, data=offertest, auto.key=T)
densityplot(~purchase_amt | offers, data=offertest)
densityplot(~log10(purchase_amt) | offers, data=offertest)
library(ggplot2)
ggplot(data=offertest, aes(x=as.factor(offers), y=purchase_amt)) +
geom_point(position="jitter", alpha=0.2) +
geom_boxplot(alpha=0.1, outlier.size=0) +
scale_y_log10()
ggplot(data=offertest) + geom_density(aes(x=purchase_amt,
colour=as.factor(offers)))
ggplot(data=offertest) + geom_density(aes(x=purchase_amt,
colour=as.factor(offers))) + scale_x_log10()
library(ggplot2)
ggplot(data=offertest, aes(x=as.factor(offers), y=purchase_amt)) +
geom_point(position="jitter", alpha=0.2) +
geom_boxplot(alpha=0.1, outlier.size=0) +
scale_y_log10()
ggplot(data=offertest) + geom_density(aes(x=purchase_amt,
colour=as.factor(offers)))
ggplot(data=offertest) + geom_density(aes(x=purchase_amt,
colour=as.factor(offers))) + scale_x_log10()
x = rnorm(10) # distribution centered at 0
y = rnorm(10,2) # distribution centered at 2
pooled.var = function(x, y) {
nx = length(x)
ny = length(y)
stdx = sd(x)
stdy = sd(y)
num = (nx-1)*stdx^2 + (ny-1)*stdy^2
denom = nx+ny-2  # degrees of freedom
(num/denom) * (1/nx + 1/ny)
}
mx = mean(x)
my = mean(y)
mx - my
pooled.var(x,y)
tstat = (mean(x) - mean(y))/sqrt(pooled.var(x,y))
tstat
dof = length(x) + length(y) - 2
dof
tailarea = pt(tstat, dof)
pvalue = 2 * tailarea
t.test(x, y, var.equal=T)
#
#
# Does t.test() give the same results?
load(file="Labs.Rdata")
ls()
rm(lab2)
ds <- lab1
colnames(ds) <- c("income", "rooms")
View(lab1)
summary(ds$income)
range(ds$income)
sd(ds$income)
var(ds$income)
plot(density(ds$income))  # left skewed
summary(ds$rooms)
range(ds$rooms)
sd(ds$rooms)
plot(as.factor(ds$rooms))
breaks <- c(0, 23000, 52000, 82000, 250000, 999999)
labels <- c("Poverty", "LowerMid", "UpperMid", "Wealthy", "Rich")
wealth <- cut(ds$income, breaks, labels)
# add wealth as a column to ds
ds <- cbind(ds, wealth)
# show the 1st few lines.
head(ds)
wt <- table(wealth)
percent <- wt/sum(wt)*100
wt <- rbind(wt, percent)
wt
plot(wt)    # this kind of sucks
wt <- table(wealth)
percent <- wt/sum(wt)*100
wt <- cbind(wt, percent)
wt
plot(wt)    # this kind of sucks
(m <- mean(ds$income, trim=0.10) )
ds <- subset(ds, ds$income  >= 10000 & ds$income < 1000000)
summary(ds)
quantile(ds$income, seq(from=0, to=1, length=11))
breaks <- c(0, 23000, 52000, 82000, 250000, 999999)
labels <- c("Poverty", "LowerMid", "UpperMid", "Wealthy", "Rich")
wealth <- cut(ds$income, breaks, labels)
# add wealth as a column to ds
ds <- cbind(ds, wealth)
# show the 1st few lines.
head(ds)
wt <- table(wealth)
percent <- wt/sum(wt)*100
wt <- cbind(wt, percent)
wt
plot(wt)    # this kind of sucks
ls()
load(file="Labs.Rdata")
ls()
rm(lab2)
ds <- lab1
colnames(ds) <- c("income", "rooms")
summary(ds$income)
range(ds$income)
sd(ds$income)
var(ds$income)
plot(density(ds$income))  # left skewed
summary(ds$rooms)
range(ds$rooms)
sd(ds$rooms)
plot(as.factor(ds$rooms))
(m <- mean(ds$income, trim=0.10) )
ds <- subset(ds, ds$income  >= 10000 & ds$income < 1000000)
summary(ds)
quantile(ds$income, seq(from=0, to=1, length=11))
breaks <- c(0, 23000, 52000, 82000, 250000, 999999)
labels <- c("Poverty", "LowerMid", "UpperMid", "Wealthy", "Rich")
wealth <- cut(ds$income, breaks, labels)
# add wealth as a column to ds
ds <- cbind(ds, wealth)
# show the 1st few lines.
head(ds)
wt <- table(wealth)
percent <- wt/sum(wt)*100
wt <- cbind(wt, percent)
wt
plot(wt)    # this kind of sucks
nt <- table(wealth, ds$rooms)
print(nt)
# nice mosaic plot
plot(nt)
rm(wealth,breaks,labels)
save(ds, wt, nt, file="Census.Rdata")
library(MASS)
# Step 1: Start R and Read the Data Set Back Into Your Workspace
setwd("C:/Users/naman/Desktop/LECTURES/LECTURES-sem5/dm/Experiment 2")
options(digits=3)
ls()
